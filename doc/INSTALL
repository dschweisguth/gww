This document describes how to install GWW on a Mac (OS 10.6, for development,
using webrick) or Linux server (CentOS 5.4, for production, using Apache httpd
and Phusion Passenger). It covers only what Dave thinks is not obvious; please
fill gaps as you encounter them.

Install and start mysql
-----------------------

    Mac
	If you don't already have it, install MacPorts from www.macports.org
	> sudo port install mysql5-server
	> sudo port load mysql5-server # as directed by the previous command
	> sudo -u _mysql mysql_install_db5
	> /opt/local/lib/mysql5/bin/mysql_secure_installation # as directed
	> ln -s /opt/local/var/run/mysql5/mysqld.sock /tmp
    Linux
        TODO

Install ruby and friends
------------------------

GWW currently requires ruby 1.8.something (the current version of 1.9 is too
new), rubygems and the gems listed below. The specific versions are not
necessarily required, but they're what I have.

Install ruby
    Mac
	> sudo port install ruby
	> ruby --version
	ruby 1.8.7 (2010-06-23 patchlevel 299) [i686-darwin10]
    Linux
	Get source from http://www.ruby-lang.org/en/ and follow instructions
	> ruby --version
	ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]

Install gem
    Mac
	> sudo port install rb-rubygems
	> sudo gem update --system
        > gem --version
        1.3.7
    Linux: Get source from http://gems.rubyforge.org/ and follow instructions.
	> gem --version
	1.3.7

Install gems

    > gem install rails
    > gem install rake
    > gem list
    actionmailer (2.3.8)
    actionpack (2.3.8)
    activerecord (2.3.8)
    activeresource (2.3.8)
    activesupport (2.3.8)
    rack (1.1.0)
    rails (2.3.8)
    rake (0.8.7)
    rubygems-update (1.3.7)

Install Phusion Passenger (for Linux production)
------------------------------------------------

> gem install passenger
> passenger-install-apache2-module # and follow instructions
In addition to editing httpd.conf as instructed by passenger, add the following
option to the appropriate place in your httpd configuration to enable GWW's
.htaccess: AllowOverride AuthConfig FileInfo

Get and configure GWW
---------------------

Get the source: Either
    > git clone git@github.com:dschweisguth/gww.git, or
    Browse http://github.com/dschweisguth/gww, click "Download Source", pick a
        format, download it and unpack it
Install gems:
    > rake gems:install
    > gem list
    actionmailer (2.3.8)
    actionpack (2.3.8)
    activerecord (2.3.8)
    activeresource (2.3.8)
    activesupport (2.3.8)
    mysql (2.8.1)
    rack (1.1.0)
    rails (2.3.8)
    rake (0.8.7)
    rubygems-update (1.3.7)
    will_paginate (2.3.14)
    xml-simple (1.0.12)
On Mac OS 10.6 only,
    > sudo gem uninstall mysql
    > sudo env ARCHFLAGS="-arch x86_64" gem install mysql -- --with-mysql-config=/opt/local/bin/mysql_config5
Configure:
    Configure database credentials:
	> cp config/database{_template,}.yml
	Edit and fill in your database username and password
    Configure Flickr credentials:
	> cp config/flickr_credentials{_template,}.yml
	Construct a Flickr API secret, key and auth token manually per the
	    API documentation
	Edit and fill in your secret, api_key and auth_token
For production Linux httpd, configure basic HTTP authentication:
    Create a username and password per
        http://httpd.apache.org/docs/2.2/howto/auth.html
    > cp public/admin/.htaccess{_template,}
    Edit and fill in
    - the full path to the htpasswd file that you just created. Note that
      it should not be in or below GWW's public directory.
    - the username

Create databases
----------------

mysql> grant usage on *.* to gww@localhost identified by '(the password)';
Create dev database:
    mysql> grant all privileges on gww_dev.* to gww@localhost;
    > rake db:create
    > gzcat gww_production-######-##:##.sql.gz | mysql -ugww -p gww_dev
Create production database:
    mysql> grant all privileges on gww_production.* to gww@localhost;
    > rake RAILS_ENV=production db:create
    > gzcat gww_production-######-##:##.sql.gz | mysql -ugww -p gww_production
Create test database:
    mysql> grant all privileges on gww_test.* to gww@localhost;
    > rake RAILS_ENV=test db:create
    > rake db:test:clone_structure

Test GWW
--------

> rake test

Start GWW
---------

Development:
    > script/server
    Browse localhost:3000
Production (Linux):
    Start or restart httpd
    Browse http://your-production-server/
